<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="API documentation for the Rust `Signer` struct in crate `trust_dns`."><meta name="keywords" content="rust, rustlang, rust-lang, Signer"><title>trust_dns::rr::dnssec::Signer - Rust</title><link rel="stylesheet" type="text/css" href="../../../normalize.css"><link rel="stylesheet" type="text/css" href="../../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../../dark.css"><link rel="stylesheet" type="text/css" href="../../../light.css" id="themeStyle"><script src="../../../storage.js"></script><noscript><link rel="stylesheet" href="../../../noscript.css"></noscript><link rel="shortcut icon" href="../../../favicon.ico"><style type="text/css">#crate-search{background-image:url("../../../down-arrow.svg");}</style></head><body class="rustdoc struct"><!--[if lte IE 8]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu">&#9776;</div><a href='../../../trust_dns/index.html'><img src='../../../rust-logo.png' alt='logo' width='100'></a><p class='location'>Struct Signer</p><div class="sidebar-elems"><div class="block items"><a class="sidebar-title" href="#methods">Methods</a><div class="sidebar-links"><a href="#method.algorithm">algorithm</a><a href="#method.calculate_key_tag">calculate_key_tag</a><a href="#method.dnssec">dnssec</a><a href="#method.is_zone_signing_key">is_zone_signing_key</a><a href="#method.key">key</a><a href="#method.new">new</a><a href="#method.sig0">sig0</a><a href="#method.sig_duration">sig_duration</a><a href="#method.sign">sign</a><a href="#method.sign_message">sign_message</a><a href="#method.signer_name">signer_name</a><a href="#method.test_key">test_key</a><a href="#method.to_dnskey">to_dnskey</a></div><a class="sidebar-title" href="#implementations">Trait Implementations</a><div class="sidebar-links"><a href="#impl-MessageFinalizer">MessageFinalizer</a></div><a class="sidebar-title" href="#synthetic-implementations">Auto Trait Implementations</a><div class="sidebar-links"><a href="#impl-Send">Send</a><a href="#impl-Sync">Sync</a></div><a class="sidebar-title" href="#blanket-implementations">Blanket Implementations</a><div class="sidebar-links"><a href="#impl-Any">Any</a><a href="#impl-Borrow">Borrow</a><a href="#impl-BorrowMut">BorrowMut</a><a href="#impl-Erased">Erased</a><a href="#impl-From">From</a><a href="#impl-Into">Into</a><a href="#impl-TryFrom">TryFrom</a><a href="#impl-TryInto">TryInto</a></div></div><p class='location'><a href='../../index.html'>trust_dns</a>::<wbr><a href='../index.html'>rr</a>::<wbr><a href='index.html'>dnssec</a></p><script>window.sidebarCurrent = {name: 'Signer', ty: 'struct', relpath: ''};</script><script defer src="sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!"><img src="../../../brush.svg" width="18" alt="Pick another theme!"></button><div id="theme-choices"></div></div><script src="../../../theme.js"></script><nav class="sub"><form class="search-form js-only"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><a id="settings-menu" href="../../../settings.html"><img src="../../../wheel.svg" width="18" alt="Change settings"></a></div></form></nav><section id="main" class="content"><h1 class='fqn'><span class='out-of-band'><span id='render-detail'><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class='inner'>&#x2212;</span>]</a></span><a class='srclink' href='../../../src/trust_dns/rr/dnssec/signer.rs.html#239-247' title='goto source code'>[src]</a></span><span class='in-band'>Struct <a href='../../index.html'>trust_dns</a>::<wbr><a href='../index.html'>rr</a>::<wbr><a href='index.html'>dnssec</a>::<wbr><a class="struct" href=''>Signer</a></span></h1><div class="docblock type-decl hidden-by-usual-hider"><pre class='rust struct'>pub struct Signer { /* fields omitted */ }</pre></div><div class='docblock'><p>Use for performing signing and validation of DNSSec based components.</p>
<p>TODO: warning this struct and it's impl are under high volatility, expect breaking changes</p>
<p><a href="https://tools.ietf.org/html/rfc4035">RFC 4035</a>, DNSSEC Protocol Modifications, March 2005</p>
<pre><code class="language-text">5.3.  Authenticating an RRset with an RRSIG RR

   A validator can use an RRSIG RR and its corresponding DNSKEY RR to
   attempt to authenticate RRsets.  The validator first checks the RRSIG
   RR to verify that it covers the RRset, has a valid time interval, and
   identifies a valid DNSKEY RR.  The validator then constructs the
   canonical form of the signed data by appending the RRSIG RDATA
   (excluding the Signature Field) with the canonical form of the
   covered RRset.  Finally, the validator uses the public key and
   signature to authenticate the signed data.  Sections 5.3.1, 5.3.2,
   and 5.3.3 describe each step in detail.

5.3.1.  Checking the RRSIG RR Validity

   A security-aware resolver can use an RRSIG RR to authenticate an
   RRset if all of the following conditions hold:

   o  The RRSIG RR and the RRset MUST have the same owner name and the
      same class.

   o  The RRSIG RR's Signer's Name field MUST be the name of the zone
      that contains the RRset.

   o  The RRSIG RR's Type Covered field MUST equal the RRset's type.

   o  The number of labels in the RRset owner name MUST be greater than
      or equal to the value in the RRSIG RR's Labels field.

   o  The validator's notion of the current time MUST be less than or
      equal to the time listed in the RRSIG RR's Expiration field.

   o  The validator's notion of the current time MUST be greater than or
      equal to the time listed in the RRSIG RR's Inception field.

   o  The RRSIG RR's Signer's Name, Algorithm, and Key Tag fields MUST
      match the owner name, algorithm, and key tag for some DNSKEY RR in
      the zone's apex DNSKEY RRset.

   o  The matching DNSKEY RR MUST be present in the zone's apex DNSKEY
      RRset, and MUST have the Zone Flag bit (DNSKEY RDATA Flag bit 7)
      set.

   It is possible for more than one DNSKEY RR to match the conditions
   above.  In this case, the validator cannot predetermine which DNSKEY
   RR to use to authenticate the signature, and it MUST try each
   matching DNSKEY RR until either the signature is validated or the
   validator has run out of matching public keys to try.

   Note that this authentication process is only meaningful if the
   validator authenticates the DNSKEY RR before using it to validate
   signatures.  The matching DNSKEY RR is considered to be authentic if:

   o  the apex DNSKEY RRset containing the DNSKEY RR is considered
      authentic; or

   o  the RRset covered by the RRSIG RR is the apex DNSKEY RRset itself,
      and the DNSKEY RR either matches an authenticated DS RR from the
      parent zone or matches a trust anchor.

5.3.2.  Reconstructing the Signed Data

   Once the RRSIG RR has met the validity requirements described in
   Section 5.3.1, the validator has to reconstruct the original signed
   data.  The original signed data includes RRSIG RDATA (excluding the
   Signature field) and the canonical form of the RRset.  Aside from
   being ordered, the canonical form of the RRset might also differ from
   the received RRset due to DNS name compression, decremented TTLs, or
   wildcard expansion.  The validator should use the following to
   reconstruct the original signed data:

         signed_data = RRSIG_RDATA | RR(1) | RR(2)...  where

            &quot;|&quot; denotes concatenation

            RRSIG_RDATA is the wire format of the RRSIG RDATA fields
               with the Signature field excluded and the Signer's Name
               in canonical form.

            RR(i) = name | type | class | OrigTTL | RDATA length | RDATA

               name is calculated according to the function below

               class is the RRset's class

               type is the RRset type and all RRs in the class

               OrigTTL is the value from the RRSIG Original TTL field

               All names in the RDATA field are in canonical form

               The set of all RR(i) is sorted into canonical order.

            To calculate the name:
               let rrsig_labels = the value of the RRSIG Labels field

               let fqdn = RRset's fully qualified domain name in
                               canonical form

               let fqdn_labels = Label count of the fqdn above.

               if rrsig_labels = fqdn_labels,
                   name = fqdn

               if rrsig_labels &lt; fqdn_labels,
                  name = &quot;*.&quot; | the rightmost rrsig_label labels of the
                                fqdn

               if rrsig_labels &gt; fqdn_labels
                  the RRSIG RR did not pass the necessary validation
                  checks and MUST NOT be used to authenticate this
                  RRset.

   The canonical forms for names and RRsets are defined in [RFC4034].

   NSEC RRsets at a delegation boundary require special processing.
   There are two distinct NSEC RRsets associated with a signed delegated
   name.  One NSEC RRset resides in the parent zone, and specifies which
   RRsets are present at the parent zone.  The second NSEC RRset resides
   at the child zone and identifies which RRsets are present at the apex
   in the child zone.  The parent NSEC RRset and child NSEC RRset can
   always be distinguished as only a child NSEC RR will indicate that an
   SOA RRset exists at the name.  When reconstructing the original NSEC
   RRset for the delegation from the parent zone, the NSEC RRs MUST NOT
   be combined with NSEC RRs from the child zone.  When reconstructing
   the original NSEC RRset for the apex of the child zone, the NSEC RRs
   MUST NOT be combined with NSEC RRs from the parent zone.

   Note that each of the two NSEC RRsets at a delegation point has a
   corresponding RRSIG RR with an owner name matching the delegated
   name, and each of these RRSIG RRs is authoritative data associated
   with the same zone that contains the corresponding NSEC RRset.  If
   necessary, a resolver can tell these RRSIG RRs apart by checking the
   Signer's Name field.

5.3.3.  Checking the Signature

   Once the resolver has validated the RRSIG RR as described in Section
   5.3.1 and reconstructed the original signed data as described in
   Section 5.3.2, the validator can attempt to use the cryptographic
   signature to authenticate the signed data, and thus (finally!)
   authenticate the RRset.

   The Algorithm field in the RRSIG RR identifies the cryptographic
   algorithm used to generate the signature.  The signature itself is
   contained in the Signature field of the RRSIG RDATA, and the public
   key used to verify the signature is contained in the Public Key field
   of the matching DNSKEY RR(s) (found in Section 5.3.1).  [RFC4034]
   provides a list of algorithm types and provides pointers to the
   documents that define each algorithm's use.

   Note that it is possible for more than one DNSKEY RR to match the
   conditions in Section 5.3.1.  In this case, the validator can only
   determine which DNSKEY RR is correct by trying each matching public
   key until the validator either succeeds in validating the signature
   or runs out of keys to try.

   If the Labels field of the RRSIG RR is not equal to the number of
   labels in the RRset's fully qualified owner name, then the RRset is
   either invalid or the result of wildcard expansion.  The resolver
   MUST verify that wildcard expansion was applied properly before
   considering the RRset to be authentic.  Section 5.3.4 describes how
   to determine whether a wildcard was applied properly.

   If other RRSIG RRs also cover this RRset, the local resolver security
   policy determines whether the resolver also has to test these RRSIG
   RRs and how to resolve conflicts if these RRSIG RRs lead to differing
   results.

   If the resolver accepts the RRset as authentic, the validator MUST
   set the TTL of the RRSIG RR and each RR in the authenticated RRset to
   a value no greater than the minimum of:

   o  the RRset's TTL as received in the response;

   o  the RRSIG RR's TTL as received in the response;

   o  the value in the RRSIG RR's Original TTL field; and

   o  the difference of the RRSIG RR's Signature Expiration time and the
      current time.

5.3.4.  Authenticating a Wildcard Expanded RRset Positive Response

   If the number of labels in an RRset's owner name is greater than the
   Labels field of the covering RRSIG RR, then the RRset and its
   covering RRSIG RR were created as a result of wildcard expansion.
   Once the validator has verified the signature, as described in
   Section 5.3, it must take additional steps to verify the non-
   existence of an exact match or closer wildcard match for the query.
   Section 5.4 discusses these steps.

   Note that the response received by the resolver should include all
   NSEC RRs needed to authenticate the response (see Section 3.1.3).
</code></pre>
</div><h2 id='methods' class='small-section-header'>Methods<a href='#methods' class='anchor'></a></h2><h3 id='impl' class='impl'><code class='in-band'>impl <a class="struct" href="../../../trust_dns/rr/dnssec/struct.Signer.html" title="struct trust_dns::rr::dnssec::Signer">Signer</a></code><a href='#impl' class='anchor'></a><a class='srclink' href='../../../src/trust_dns/rr/dnssec/signer.rs.html#255-516' title='goto source code'>[src]</a></h3><div class='impl-items'><h4 id='method.dnssec' class="method"><code id='dnssec.v'>pub fn <a href='#method.dnssec' class='fnname'>dnssec</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;key_rdata: <a class="struct" href="../../../trust_dns/rr/rdata/dnskey/struct.DNSKEY.html" title="struct trust_dns::rr::rdata::dnskey::DNSKEY">DNSKEY</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;key: <a class="enum" href="../../../trust_dns/rr/dnssec/enum.KeyPair.html" title="enum trust_dns::rr::dnssec::KeyPair">KeyPair</a>&lt;<a class="enum" href="../../../trust_dns/rr/dnssec/enum.Private.html" title="enum trust_dns::rr::dnssec::Private">Private</a>&gt;, <br>&nbsp;&nbsp;&nbsp;&nbsp;signer_name: <a class="struct" href="../../../trust_dns/rr/struct.Name.html" title="struct trust_dns::rr::Name">Name</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;sig_duration: <a class="struct" href="https://doc.rust-lang.org/time/time/duration/struct.Duration.html" title="struct time::duration::Duration">Duration</a><br>) -&gt; Self</code><a class='srclink' href='../../../src/trust_dns/rr/dnssec/signer.rs.html#265-282' title='goto source code'>[src]</a></h4><div class='docblock'><p>Version of Signer for verifying RRSIGs and SIG0 records.</p>
<h1 id="arguments" class="section-header"><a href="#arguments">Arguments</a></h1>
<ul>
<li><code>key_rdata</code> - the DNSKEY and public key material</li>
<li><code>key</code> - the private key for signing, unless validating, where just the public key is necessary</li>
<li><code>signer_name</code> - name in the zone to which this DNSKEY is bound</li>
<li><code>sig_duration</code> - time period for which this key is valid, 0 when verifying</li>
<li><code>is_zone_update_auth</code> - this key may be used for updating the zone</li>
</ul>
</div><h4 id='method.sig0' class="method"><code id='sig0.v'>pub fn <a href='#method.sig0' class='fnname'>sig0</a>(key_rdata: <a class="struct" href="../../../trust_dns/rr/rdata/key/struct.KEY.html" title="struct trust_dns::rr::rdata::key::KEY">KEY</a>, key: <a class="enum" href="../../../trust_dns/rr/dnssec/enum.KeyPair.html" title="enum trust_dns::rr::dnssec::KeyPair">KeyPair</a>&lt;<a class="enum" href="../../../trust_dns/rr/dnssec/enum.Private.html" title="enum trust_dns::rr::dnssec::Private">Private</a>&gt;, signer_name: <a class="struct" href="../../../trust_dns/rr/struct.Name.html" title="struct trust_dns::rr::Name">Name</a>) -&gt; Self</code><a class='srclink' href='../../../src/trust_dns/rr/dnssec/signer.rs.html#292-303' title='goto source code'>[src]</a></h4><div class='docblock'><p>Version of Signer for verifying RRSIGs and SIG0 records.</p>
<h1 id="arguments-1" class="section-header"><a href="#arguments-1">Arguments</a></h1>
<ul>
<li><code>key_rdata</code> - the KEY and public key material</li>
<li><code>key</code> - the private key for signing, unless validating, where just the public key is necessary</li>
<li><code>signer_name</code> - name in the zone to which this DNSKEY is bound</li>
<li><code>is_zone_update_auth</code> - this key may be used for updating the zone</li>
</ul>
</div><h4 id='method.new' class="method"><code id='new.v'>pub fn <a href='#method.new' class='fnname'>new</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;algorithm: <a class="enum" href="../../../trust_dns/rr/dnssec/enum.Algorithm.html" title="enum trust_dns::rr::dnssec::Algorithm">Algorithm</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;key: <a class="enum" href="../../../trust_dns/rr/dnssec/enum.KeyPair.html" title="enum trust_dns::rr::dnssec::KeyPair">KeyPair</a>&lt;<a class="enum" href="../../../trust_dns/rr/dnssec/enum.Private.html" title="enum trust_dns::rr::dnssec::Private">Private</a>&gt;, <br>&nbsp;&nbsp;&nbsp;&nbsp;signer_name: <a class="struct" href="../../../trust_dns/rr/struct.Name.html" title="struct trust_dns::rr::Name">Name</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;sig_duration: <a class="struct" href="https://doc.rust-lang.org/time/time/duration/struct.Duration.html" title="struct time::duration::Duration">Duration</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;is_zone_signing_key: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;_: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a><br>) -&gt; Self</code><a class='srclink' href='../../../src/trust_dns/rr/dnssec/signer.rs.html#307-327' title='goto source code'>[src]</a></h4><div class='stability'><div class='stab deprecated'>Deprecated: <p>use SIG0 or DNSSec constructors</p>
</div></div><div class='docblock'><p>Version of Signer for signing RRSIGs and SIG0 records.</p>
</div><h4 id='method.key' class="method"><code id='key.v'>pub fn <a href='#method.key' class='fnname'>key</a>(&amp;self) -&gt; &amp;<a class="enum" href="../../../trust_dns/rr/dnssec/enum.KeyPair.html" title="enum trust_dns::rr::dnssec::KeyPair">KeyPair</a>&lt;<a class="enum" href="../../../trust_dns/rr/dnssec/enum.Private.html" title="enum trust_dns::rr::dnssec::Private">Private</a>&gt;</code><a class='srclink' href='../../../src/trust_dns/rr/dnssec/signer.rs.html#330-332' title='goto source code'>[src]</a></h4><div class='docblock'><p>Return the key used for validation/signing</p>
</div><h4 id='method.sig_duration' class="method"><code id='sig_duration.v'>pub fn <a href='#method.sig_duration' class='fnname'>sig_duration</a>(&amp;self) -&gt; <a class="struct" href="https://doc.rust-lang.org/time/time/duration/struct.Duration.html" title="struct time::duration::Duration">Duration</a></code><a class='srclink' href='../../../src/trust_dns/rr/dnssec/signer.rs.html#335-337' title='goto source code'>[src]</a></h4><div class='docblock'><p>Returns the duration that this signature is valid for</p>
</div><h4 id='method.is_zone_signing_key' class="method"><code id='is_zone_signing_key.v'>pub fn <a href='#method.is_zone_signing_key' class='fnname'>is_zone_signing_key</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.bool.html">bool</a></code><a class='srclink' href='../../../src/trust_dns/rr/dnssec/signer.rs.html#340-342' title='goto source code'>[src]</a></h4><div class='docblock'><p>A hint to the DNSKey associated with this Signer can be used to sign/validate records in the zone</p>
</div><h4 id='method.sign' class="method"><code id='sign.v'>pub fn <a href='#method.sign' class='fnname'>sign</a>(&amp;self, tbs: &amp;<a class="struct" href="../../../trust_dns/rr/dnssec/struct.TBS.html" title="struct trust_dns::rr::dnssec::TBS">TBS</a>) -&gt; <a class="type" href="../../../trust_dns_proto/error/type.ProtoResult.html" title="type trust_dns_proto::error::ProtoResult">ProtoResult</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>&gt;&gt;</code><a class='srclink' href='../../../src/trust_dns/rr/dnssec/signer.rs.html#355-359' title='goto source code'>[src]</a></h4><div class='docblock'><p>Signs a hash.</p>
<p>This will panic if the <code>key</code> is not a private key and can be used for signing.</p>
<h1 id="arguments-2" class="section-header"><a href="#arguments-2">Arguments</a></h1>
<ul>
<li><code>hash</code> - the hashed resource record set, see <code>rrset_tbs</code>.</li>
</ul>
<h1 id="return-value" class="section-header"><a href="#return-value">Return value</a></h1>
<p>The signature, ready to be stored in an <code>RData::RRSIG</code>.</p>
</div><h4 id='method.algorithm' class="method"><code id='algorithm.v'>pub fn <a href='#method.algorithm' class='fnname'>algorithm</a>(&amp;self) -&gt; <a class="enum" href="../../../trust_dns/rr/dnssec/enum.Algorithm.html" title="enum trust_dns::rr::dnssec::Algorithm">Algorithm</a></code><a class='srclink' href='../../../src/trust_dns/rr/dnssec/signer.rs.html#362-364' title='goto source code'>[src]</a></h4><div class='docblock'><p>Returns the algorithm this Signer will use to either sign or validate a signature</p>
</div><h4 id='method.signer_name' class="method"><code id='signer_name.v'>pub fn <a href='#method.signer_name' class='fnname'>signer_name</a>(&amp;self) -&gt; &amp;<a class="struct" href="../../../trust_dns/rr/struct.Name.html" title="struct trust_dns::rr::Name">Name</a></code><a class='srclink' href='../../../src/trust_dns/rr/dnssec/signer.rs.html#369-371' title='goto source code'>[src]</a></h4><div class='docblock'><p>The name of the signing entity, e.g. the DNS server name.</p>
<p>This should match the name on key in the zone.</p>
</div><h4 id='method.calculate_key_tag' class="method"><code id='calculate_key_tag.v'>pub fn <a href='#method.calculate_key_tag' class='fnname'>calculate_key_tag</a>(&amp;self) -&gt; <a class="type" href="../../../trust_dns_proto/error/type.ProtoResult.html" title="type trust_dns_proto::error::ProtoResult">ProtoResult</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u16.html">u16</a>&gt;</code><a class='srclink' href='../../../src/trust_dns/rr/dnssec/signer.rs.html#427-434' title='goto source code'>[src]</a></h4><div class='docblock'><p>The key tag is calculated as a hash to more quickly lookup a DNSKEY.</p>
<p><a href="https://tools.ietf.org/html/rfc1035">RFC 1035</a>, DOMAIN NAMES - IMPLEMENTATION AND SPECIFICATION, November 1987</p>
<pre><code class="language-text">RFC 2535                DNS Security Extensions               March 1999

4.1.6 Key Tag Field

 The &quot;key Tag&quot; is a two octet quantity that is used to efficiently
 select between multiple keys which may be applicable and thus check
 that a public key about to be used for the computationally expensive
 effort to check the signature is possibly valid.  For algorithm 1
 (MD5/RSA) as defined in [RFC 2537], it is the next to the bottom two
 octets of the public key modulus needed to decode the signature
 field.  That is to say, the most significant 16 of the least
 significant 24 bits of the modulus in network (big endian) order. For
 all other algorithms, including private algorithms, it is calculated
 as a simple checksum of the KEY RR as described in Appendix C.

Appendix C: Key Tag Calculation

 The key tag field in the SIG RR is just a means of more efficiently
 selecting the correct KEY RR to use when there is more than one KEY
 RR candidate available, for example, in verifying a signature.  It is
 possible for more than one candidate key to have the same tag, in
 which case each must be tried until one works or all fail.  The
 following reference implementation of how to calculate the Key Tag,
 for all algorithms other than algorithm 1, is in ANSI C.  It is coded
 for clarity, not efficiency.  (See section 4.1.6 for how to determine
 the Key Tag of an algorithm 1 key.)

 /* assumes int is at least 16 bits
    first byte of the key tag is the most significant byte of return
    value
    second byte of the key tag is the least significant byte of
    return value
    */

 int keytag (

         unsigned char key[],  /* the RDATA part of the KEY RR */
         unsigned int keysize, /* the RDLENGTH */
         )
 {
 long int    ac;    /* assumed to be 32 bits or larger */

 for ( ac = 0, i = 0; i &lt; keysize; ++i )
     ac += (i&amp;1) ? key[i] : key[i]&lt;&lt;8;
 ac += (ac&gt;&gt;16) &amp; 0xFFFF;
 return ac &amp; 0xFFFF;
 }
</code></pre>
</div><h4 id='method.sign_message' class="method"><code id='sign_message.v'>pub fn <a href='#method.sign_message' class='fnname'>sign_message</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;self, <br>&nbsp;&nbsp;&nbsp;&nbsp;message: &amp;<a class="struct" href="../../../trust_dns/op/struct.Message.html" title="struct trust_dns::op::Message">Message</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;pre_sig0: &amp;<a class="struct" href="../../../trust_dns/rr/rdata/sig/struct.SIG.html" title="struct trust_dns::rr::rdata::sig::SIG">SIG</a><br>) -&gt; <a class="type" href="../../../trust_dns_proto/error/type.ProtoResult.html" title="type trust_dns_proto::error::ProtoResult">ProtoResult</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u8.html">u8</a>&gt;&gt;</code><a class='srclink' href='../../../src/trust_dns/rr/dnssec/signer.rs.html#491-493' title='goto source code'>[src]</a></h4><div class='docblock'><p>Signs the given message, returning the signature bytes.</p>
<h1 id="arguments-3" class="section-header"><a href="#arguments-3">Arguments</a></h1>
<ul>
<li><code>message</code> - the message to sign</li>
</ul>
<p><a href="https://tools.ietf.org/html/rfc2535#section-4.1.8.1">rfc2535</a>, Domain Name System Security Extensions, 1999</p>
<pre><code class="language-text">4.1.8.1 Calculating Transaction and Request SIGs

 A response message from a security aware server may optionally
 contain a special SIG at the end of the additional information
 section to authenticate the transaction.

 This SIG has a &quot;type covered&quot; field of zero, which is not a valid RR
 type.  It is calculated by using a &quot;data&quot; (see Section 4.1.8) of the
 entire preceding DNS reply message, including DNS header but not the
 IP header and before the reply RR counts have been adjusted for the
 inclusion of any transaction SIG, concatenated with the entire DNS
 query message that produced this response, including the query's DNS
 header and any request SIGs but not its IP header.  That is

 data = full response (less transaction SIG) | full query

 Verification of the transaction SIG (which is signed by the server
 host key, not the zone key) by the requesting resolver shows that the
 query and response were not tampered with in transit, that the
 response corresponds to the intended query, and that the response
 comes from the queried server.

 A DNS request may be optionally signed by including one or more SIGs
 at the end of the query. Such SIGs are identified by having a &quot;type
 covered&quot; field of zero. They sign the preceding DNS request message
 including DNS header but not including the IP header or any request
 SIGs at the end and before the request RR counts have been adjusted
 for the inclusions of any request SIG(s).

 WARNING: Request SIGs are unnecessary for any currently defined
 request other than update [RFC 2136, 2137] and will cause some old
 DNS servers to give an error return or ignore a query.  However, such
 SIGs may in the future be needed for other requests.

 Except where needed to authenticate an update or similar privileged
 request, servers are not required to check request SIGs.
</code></pre>
<hr />
<p>NOTE: In classic RFC style, this is unclear, it implies that each SIG record is not included in
the Additional record count, but this makes it more difficult to process and calculate more
than one SIG0 record. Annoyingly, it means that the Header is signed with different material
(i.e. additional record count - #SIG0 records), so the exact header sent is NOT the header
being verified.</p>
<hr />
</div><h4 id='method.to_dnskey' class="method"><code id='to_dnskey.v'>pub fn <a href='#method.to_dnskey' class='fnname'>to_dnskey</a>(&amp;self) -&gt; <a class="type" href="../../../trust_dns/error/type.DnsSecResult.html" title="type trust_dns::error::DnsSecResult">DnsSecResult</a>&lt;<a class="struct" href="../../../trust_dns/rr/rdata/dnskey/struct.DNSKEY.html" title="struct trust_dns::rr::rdata::dnskey::DNSKEY">DNSKEY</a>&gt;</code><a class='srclink' href='../../../src/trust_dns/rr/dnssec/signer.rs.html#496-501' title='goto source code'>[src]</a></h4><div class='docblock'><p>Extracts a public KEY from this Signer</p>
</div><h4 id='method.test_key' class="method"><code id='test_key.v'>pub fn <a href='#method.test_key' class='fnname'>test_key</a>(&amp;self) -&gt; <a class="type" href="../../../trust_dns/error/type.DnsSecResult.html" title="type trust_dns::error::DnsSecResult">DnsSecResult</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.unit.html">()</a>&gt;</code><a class='srclink' href='../../../src/trust_dns/rr/dnssec/signer.rs.html#504-515' title='goto source code'>[src]</a></h4><div class='docblock'><p>Test that this key is capable of signing and verifying data</p>
</div></div><h2 id='implementations' class='small-section-header'>Trait Implementations<a href='#implementations' class='anchor'></a></h2><div id='implementations-list'><h3 id='impl-MessageFinalizer' class='impl'><code class='in-band'>impl <a class="trait" href="../../../trust_dns/op/trait.MessageFinalizer.html" title="trait trust_dns::op::MessageFinalizer">MessageFinalizer</a> for <a class="struct" href="../../../trust_dns/rr/dnssec/struct.Signer.html" title="struct trust_dns::rr::dnssec::Signer">Signer</a></code><a href='#impl-MessageFinalizer' class='anchor'></a><a class='srclink' href='../../../src/trust_dns/rr/dnssec/signer.rs.html#518-573' title='goto source code'>[src]</a></h3><div class='impl-items'><h4 id='method.finalize_message' class="method hidden"><code id='finalize_message.v'>fn <a href='../../../trust_dns/op/trait.MessageFinalizer.html#tymethod.finalize_message' class='fnname'>finalize_message</a>(<br>&nbsp;&nbsp;&nbsp;&nbsp;&amp;self, <br>&nbsp;&nbsp;&nbsp;&nbsp;message: &amp;<a class="struct" href="../../../trust_dns/op/struct.Message.html" title="struct trust_dns::op::Message">Message</a>, <br>&nbsp;&nbsp;&nbsp;&nbsp;current_time: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.u32.html">u32</a><br>) -&gt; <a class="type" href="../../../trust_dns_proto/error/type.ProtoResult.html" title="type trust_dns_proto::error::ProtoResult">ProtoResult</a>&lt;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/vec/struct.Vec.html" title="struct alloc::vec::Vec">Vec</a>&lt;<a class="struct" href="../../../trust_dns/rr/struct.Record.html" title="struct trust_dns::rr::Record">Record</a>&gt;&gt;</code><a class='srclink' href='../../../src/trust_dns/rr/dnssec/signer.rs.html#520-564' title='goto source code'>[src]</a></h4><div class='docblock hidden'><p>The message taken in should be processed and then return [<code>Record</code>]s which should be  appended to the additional section of the message. <a href="../../../trust_dns/op/trait.MessageFinalizer.html#tymethod.finalize_message">Read more</a></p>
</div></div></div><h2 id='synthetic-implementations' class='small-section-header'>Auto Trait Implementations<a href='#synthetic-implementations' class='anchor'></a></h2><div id='synthetic-implementations-list'><h3 id='impl-Send' class='impl'><code class='in-band'>impl <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> for <a class="struct" href="../../../trust_dns/rr/dnssec/struct.Signer.html" title="struct trust_dns::rr::dnssec::Signer">Signer</a></code><a href='#impl-Send' class='anchor'></a></h3><div class='impl-items'></div><h3 id='impl-Sync' class='impl'><code class='in-band'>impl <a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a> for <a class="struct" href="../../../trust_dns/rr/dnssec/struct.Signer.html" title="struct trust_dns::rr::dnssec::Signer">Signer</a></code><a href='#impl-Sync' class='anchor'></a></h3><div class='impl-items'></div></div><h2 id='blanket-implementations' class='small-section-header'>Blanket Implementations<a href='#blanket-implementations' class='anchor'></a></h2><div id='blanket-implementations-list'><h3 id='impl-Into' class='impl'><code class='in-band'>impl&lt;T, U&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.Into.html" title="trait core::convert::Into">Into</a> for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;U: <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.From.html" title="trait core::convert::From">From</a>&lt;T&gt;,&nbsp;</span></code><a href='#impl-Into' class='anchor'></a><a class='srclink' href='https://doc.rust-lang.org/nightly/src/core/convert.rs.html#498-503' title='goto source code'>[src]</a></h3><div class='impl-items'><h4 id='method.into' class="method hidden"><code id='into.v'>fn <a href='https://doc.rust-lang.org/nightly/core/convert/trait.Into.html#tymethod.into' class='fnname'>into</a>(self) -&gt; U</code><a class='srclink' href='https://doc.rust-lang.org/nightly/src/core/convert.rs.html#500-502' title='goto source code'>[src]</a></h4><div class='docblock hidden'><p>Performs the conversion.</p>
</div></div><h3 id='impl-From' class='impl'><code class='in-band'>impl&lt;T&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.From.html" title="trait core::convert::From">From</a> for T</code><a href='#impl-From' class='anchor'></a><a class='srclink' href='https://doc.rust-lang.org/nightly/src/core/convert.rs.html#507-509' title='goto source code'>[src]</a></h3><div class='impl-items'><h4 id='method.from' class="method hidden"><code id='from.v'>fn <a href='https://doc.rust-lang.org/nightly/core/convert/trait.From.html#tymethod.from' class='fnname'>from</a>(t: T) -&gt; T</code><a class='srclink' href='https://doc.rust-lang.org/nightly/src/core/convert.rs.html#508' title='goto source code'>[src]</a></h4><div class='docblock hidden'><p>Performs the conversion.</p>
</div></div><h3 id='impl-TryFrom' class='impl'><code class='in-band'>impl&lt;T, U&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a> for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;U: <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;T&gt;,&nbsp;</span></code><a href='#impl-TryFrom' class='anchor'></a><a class='srclink' href='https://doc.rust-lang.org/nightly/src/core/convert.rs.html#526-532' title='goto source code'>[src]</a></h3><div class='impl-items'><h4 id='associatedtype.Error' class="type"><code id='Error.t'>type <a href='https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html#associatedtype.Error' class="type">Error</a> = <a class="enum" href="https://doc.rust-lang.org/nightly/core/convert/enum.Infallible.html" title="enum core::convert::Infallible">Infallible</a></code></h4><div class='docblock'><p>The type returned in the event of a conversion error.</p>
</div><h4 id='method.try_from' class="method hidden"><code id='try_from.v'>fn <a href='https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html#tymethod.try_from' class='fnname'>try_from</a>(value: U) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;T, &lt;T as <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;U&gt;&gt;::<a class="type" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html#associatedtype.Error" title="type core::convert::TryFrom::Error">Error</a>&gt;</code><a class='srclink' href='https://doc.rust-lang.org/nightly/src/core/convert.rs.html#529-531' title='goto source code'>[src]</a></h4><div class='docblock hidden'><p>Performs the conversion.</p>
</div></div><h3 id='impl-Borrow' class='impl'><code class='in-band'>impl&lt;T&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/borrow/trait.Borrow.html" title="trait core::borrow::Borrow">Borrow</a> for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;T: ?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,&nbsp;</span></code><a href='#impl-Borrow' class='anchor'></a><a class='srclink' href='https://doc.rust-lang.org/nightly/src/core/borrow.rs.html#209-211' title='goto source code'>[src]</a></h3><div class='impl-items'><h4 id='method.borrow' class="method hidden"><code id='borrow.v'>fn <a href='https://doc.rust-lang.org/nightly/core/borrow/trait.Borrow.html#tymethod.borrow' class='fnname'>borrow</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;</a>T</code><a class='srclink' href='https://doc.rust-lang.org/nightly/src/core/borrow.rs.html#210' title='goto source code'>[src]</a></h4><div class='docblock hidden'><p>Immutably borrows from an owned value. <a href="https://doc.rust-lang.org/nightly/core/borrow/trait.Borrow.html#tymethod.borrow">Read more</a></p>
</div></div><h3 id='impl-Any' class='impl'><code class='in-band'>impl&lt;T&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/any/trait.Any.html" title="trait core::any::Any">Any</a> for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;T: 'static + ?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,&nbsp;</span></code><a href='#impl-Any' class='anchor'></a><a class='srclink' href='https://doc.rust-lang.org/nightly/src/core/any.rs.html#100-102' title='goto source code'>[src]</a></h3><div class='impl-items'><h4 id='method.type_id' class="method hidden"><code id='type_id.v'>fn <a href='https://doc.rust-lang.org/nightly/core/any/trait.Any.html#tymethod.type_id' class='fnname'>type_id</a>(&amp;self) -&gt; <a class="struct" href="https://doc.rust-lang.org/nightly/core/any/struct.TypeId.html" title="struct core::any::TypeId">TypeId</a></code><a class='srclink' href='https://doc.rust-lang.org/nightly/src/core/any.rs.html#101' title='goto source code'>[src]</a></h4><div class='docblock hidden'><p>Gets the <code>TypeId</code> of <code>self</code>. <a href="https://doc.rust-lang.org/nightly/core/any/trait.Any.html#tymethod.type_id">Read more</a></p>
</div></div><h3 id='impl-BorrowMut' class='impl'><code class='in-band'>impl&lt;T&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/borrow/trait.BorrowMut.html" title="trait core::borrow::BorrowMut">BorrowMut</a> for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;T: ?<a class="trait" href="https://doc.rust-lang.org/nightly/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,&nbsp;</span></code><a href='#impl-BorrowMut' class='anchor'></a><a class='srclink' href='https://doc.rust-lang.org/nightly/src/core/borrow.rs.html#214-216' title='goto source code'>[src]</a></h3><div class='impl-items'><h4 id='method.borrow_mut' class="method hidden"><code id='borrow_mut.v'>fn <a href='https://doc.rust-lang.org/nightly/core/borrow/trait.BorrowMut.html#tymethod.borrow_mut' class='fnname'>borrow_mut</a>(&amp;mut self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.reference.html">&amp;mut </a>T</code><a class='srclink' href='https://doc.rust-lang.org/nightly/src/core/borrow.rs.html#215' title='goto source code'>[src]</a></h4><div class='docblock hidden'><p>Mutably borrows from an owned value. <a href="https://doc.rust-lang.org/nightly/core/borrow/trait.BorrowMut.html#tymethod.borrow_mut">Read more</a></p>
</div></div><h3 id='impl-TryInto' class='impl'><code class='in-band'>impl&lt;T, U&gt; <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryInto.html" title="trait core::convert::TryInto">TryInto</a> for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;U: <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;T&gt;,&nbsp;</span></code><a href='#impl-TryInto' class='anchor'></a><a class='srclink' href='https://doc.rust-lang.org/nightly/src/core/convert.rs.html#514-521' title='goto source code'>[src]</a></h3><div class='impl-items'><h4 id='associatedtype.Error-1' class="type"><code id='Error.t-1'>type <a href='https://doc.rust-lang.org/nightly/core/convert/trait.TryInto.html#associatedtype.Error' class="type">Error</a> = &lt;U as <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;T&gt;&gt;::<a class="type" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html#associatedtype.Error" title="type core::convert::TryFrom::Error">Error</a></code></h4><div class='docblock'><p>The type returned in the event of a conversion error.</p>
</div><h4 id='method.try_into' class="method hidden"><code id='try_into.v'>fn <a href='https://doc.rust-lang.org/nightly/core/convert/trait.TryInto.html#tymethod.try_into' class='fnname'>try_into</a>(self) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;U, &lt;U as <a class="trait" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;T&gt;&gt;::<a class="type" href="https://doc.rust-lang.org/nightly/core/convert/trait.TryFrom.html#associatedtype.Error" title="type core::convert::TryFrom::Error">Error</a>&gt;</code><a class='srclink' href='https://doc.rust-lang.org/nightly/src/core/convert.rs.html#518-520' title='goto source code'>[src]</a></h4><div class='docblock hidden'><p>Performs the conversion.</p>
</div></div><h3 id='impl-Erased' class='impl'><code class='in-band'>impl&lt;T&gt; Erased for T</code><a href='#impl-Erased' class='anchor'></a></h3><div class='impl-items'></div></div></section><section id="search" class="content hidden"></section><section class="footer"></section><aside id="help" class="hidden"><div><h1 class="hidden">Help</h1><div class="shortcuts"><h2>Keyboard Shortcuts</h2><dl><dt><kbd>?</kbd></dt><dd>Show this help dialog</dd><dt><kbd>S</kbd></dt><dd>Focus the search field</dd><dt><kbd>↑</kbd></dt><dd>Move up in search results</dd><dt><kbd>↓</kbd></dt><dd>Move down in search results</dd><dt><kbd>↹</kbd></dt><dd>Switch tab</dd><dt><kbd>&#9166;</kbd></dt><dd>Go to active search result</dd><dt><kbd>+</kbd></dt><dd>Expand all sections</dd><dt><kbd>-</kbd></dt><dd>Collapse all sections</dd></dl></div><div class="infos"><h2>Search Tricks</h2><p>Prefix searches with a type followed by a colon (e.g., <code>fn:</code>) to restrict the search to a given type.</p><p>Accepted types are: <code>fn</code>, <code>mod</code>, <code>struct</code>, <code>enum</code>, <code>trait</code>, <code>type</code>, <code>macro</code>, and <code>const</code>.</p><p>Search functions by type signature (e.g., <code>vec -> usize</code> or <code>* -> vec</code>)</p><p>Search multiple things at once by splitting your query with comma (e.g., <code>str,u8</code> or <code>String,struct:Vec,test</code>)</p></div></div></aside><script>window.rootPath = "../../../";window.currentCrate = "trust_dns";</script><script src="../../../aliases.js"></script><script src="../../../main.js"></script><script defer src="../../../search-index.js"></script></body></html>